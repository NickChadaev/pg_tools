SELECT gar_link.f_server_crt ('unnsi_prd_et', '10.196.35.165', 'unnsi_prd_et', 5432, 'postgres', 'postgres', ''); --1
SELECT gar_link.f_schema_import ('unnsi_prd_et', 'unnsi', 'unsi', 'ЭТАЛОН от 2022-12-15'); -- 2

SELECT * FROM gar_tmp.adr_house LIMIT 100;

-- 25793288|242|16231|2|'26'||''||''|'368833'|'д. 26'|'82730000001'|'198d7492-375e-46ce-a243-fb3448164d18'|''||'82430000000'||
-- 26104588|242|16231|2|'80'||''||''|'368833'|'д. 80'|'82730000001'|'4fa741ed-6ec0-4c95-81a5-fca178910570'|''||'82430000000'||
-- 25752321|242|16231|2|'51'||''||''|'368833'|'д. 51'|'82730000001'|'12751c7b-3658-4b37-9055-fe491e142fee'|''||'82430000000'||
-- 28358914|242|16224|2|'1/1'||''||''|'368832'|'д. 1/1'|'82730000001'|'e2f30cb6-9efe-48c5-98f5-59538a8cf3e2'|''||'82430000000'||
-- 1290819|242|16290|2|'11'||''||''|'368830'|'д. 11'|'82730000001'|'17de99d1-367d-4585-abb5-5f01c056ca2d'|''||'82430000000'||
-- 1411008|242|16290|2|'15'||''||''|'368830'|'д. 15'|'82730000001'|'03c85034-3d24-48e5-bb6e-bc39390be798'|''||'82430000000'||
-- 1257634|242|16290|2|'15/3'||''||''|'368830'|'д. 15/3'|'82730000001'|'41474751-930e-445d-b5bc-231f60c523fb'|''||'82430000000'||
-- 29260168|242|16290|9|'7'||''||''|'368830'|'зд. 7'|'82730000001'|'e4790435-c35e-4ca3-b108-6998e22cb5da'|''||'82430000000'||
-- 1227260|242|16333|2|'100'||''||''|'368831'|'д. 100'|'82730000001'|'e1f99939-e0c9-4f43-9931-063e89a5e679'|''||'82430000000'||
-- 1218577|242|16333|2|'16'||''||''|'368831'|'д. 16'|'82730000001'|'4bbd593b-7aca-4831-9208-0323a841bf6c'|''||'82430000000'||

SELECT * FROM gar_tmp.adr_house WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));
-----------------------------------------------------------------------------------------------------------------------------0
-- 1290819|242|16290|2|'11'||''||''|'368830'|'д. 11'|'82730000001'|'17de99d1-367d-4585-abb5-5f01c056ca2d'|''||'82430000000'
-- 1411008|242|16290|2|'15'||''||''|'368830'|'д. 15'|'82730000001'|'03c85034-3d24-48e5-bb6e-bc39390be798'|''||'82430000000'
-- 25752321|242|16231|2|'51'||''||''|'368833'|'д. 51'|'82730000001'|'12751c7b-3658-4b37-9055-fe491e142fee'|''||'82430000000'
-- 25793288|242|16231|2|'26'||''||''|'368833'|'д. 26'|'82730000001'|'198d7492-375e-46ce-a243-fb3448164d18'|''||'82430000000'
-- 26104588|242|16231|2|'80'||''||''|'368833'|'д. 80'|'82730000001'|'4fa741ed-6ec0-4c95-81a5-fca178910570'|''||'82430000000'
-- 28358914|242|16224|2|'1/1'||''||''|'368832'|'д. 1/1'|'82730000001'|'e2f30cb6-9efe-48c5-98f5-59538a8cf3e2'|''||'82430000000'
-- 600078120|17103|275177|2|'2'||''||''|''|'д. 2'|'82720000001'|'214d4df8-ae8f-46e2-b71f-f5f329eb4fe5'|''||'82420000000'

SELECT * FROM gar_tmp.adr_house_aux WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));
-----------------------------------------------------------------------------------------
CALL gar_tmp_pcg_trans.fp_adr_house_upd_single ('gar_tmp','gar_tmp', '214d4df8-ae8f-46e2-b71f-f5f329eb4fe5', p_nm_zipcode := '368830');

SELECT * FROM gar_tmp.adr_house_aux WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));
--
--- 600078120|'U'
--
SELECT * FROM gar_tmp.adr_house WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));
------------------------------------------------------------------------------------------------------------------------------
-- 600078120|17103|275177|2|'2'||''||''|'368830'|'д. 2'|'82720000001'|'214d4df8-ae8f-46e2-b71f-f5f329eb4fe5'|''||'82420000000'
--
--  Тест на стирание данных.

CALL gar_tmp_pcg_trans.fp_adr_house_upd_single ('gar_tmp','gar_tmp', '214d4df8-ae8f-46e2-b71f-f5f329eb4fe5', p_direct_put := TRUE);

SELECT * FROM gar_tmp.adr_house WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));
---------------------------------------------------------------------------------------------------------------------------
-- 26104588|242|16231|2|'80'||''||''|'368833'|'д. 80'|'82730000001'|'4fa741ed-6ec0-4c95-81a5-fca178910570'|''||'82430000000'
-- 28358914|242|16224|2|'1/1'||''||''|'368832'|'д. 1/1'|'82730000001'|'e2f30cb6-9efe-48c5-98f5-59538a8cf3e2'|''||'82430000000'
-- 600078120|17103|||''||''||''|''|'д. 2'|''|'214d4df8-ae8f-46e2-b71f-f5f329eb4fe5'|''||''
-- ---------------------------------------------------------------------------------------------------------------------------
CALL gar_tmp_pcg_trans.fp_adr_house_upd_single ('gar_tmp','gar_tmp', '214d4df8-ae8f-46e2-b71f-f5f329eb4fe5'
       ,p_id_street := 16224, p_id_house_type_1 := 2, p_nm_house_1 := '2', p_nm_zipcode := '368830'
       ,p_kd_oktmo := '82730000001', p_kd_okato := '82430000000'	
);
--
SELECT * FROM gar_tmp.adr_house WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));
--
CALL gar_tmp_pcg_trans.fp_adr_house_upd_single ('gar_tmp','gar_tmp', '214d4df8-ae8f-46e2-b71f-f5f329eb4fe5', p_id_area := 242);
--
SELECT * FROM gar_tmp.adr_house WHERE (id_house IN (25793288, 26104588, 25752321, 28358914, 1290819, 1411008, 600078120));