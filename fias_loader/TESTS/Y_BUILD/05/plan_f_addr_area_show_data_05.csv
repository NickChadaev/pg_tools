"QUERY PLAN"
"Sort  (cost=29583.97..29583.99 rows=5 width=1330) (actual time=1366.248..1366.264 rows=13 loops=1)"
"  Sort Key: bb1.id_addr_parent, bb1.addr_obj_type, bb1.nm_addr_obj"
"  Sort Method: quicksort  Memory: 31kB"
"  CTE aa1"
"    ->  Recursive Union  (cost=250.67..29389.12 rows=41 width=642) (actual time=12.330..1211.142 rows=26543 loops=1)"
"          ->  Nested Loop  (cost=250.67..1611.99 rows=1 width=642) (actual time=12.326..17.289 rows=1 loops=1)"
"                ->  Nested Loop  (cost=250.54..1611.83 rows=1 width=339) (actual time=12.315..17.277 rows=1 loops=1)"
"                      ->  Hash Join  (cost=250.40..1611.52 rows=2 width=121) (actual time=12.289..17.249 rows=1 loops=1)"
"                            Hash Cond: (a.object_id = h1.object_id)"
"                            ->  Seq Scan on as_addr_obj a  (cost=0.00..1250.33 rows=29538 width=100) (actual time=0.020..14.447 rows=29526 loops=1)"
"                                  Filter: (end_date > CURRENT_DATE)"
"                                  Rows Removed by Filter: 6496"
"                            ->  Hash  (cost=249.67..249.67 rows=58 width=29) (actual time=0.039..0.041 rows=1 loops=1)"
"                                  Buckets: 1024  Batches: 1  Memory Usage: 9kB"
"                                  ->  Bitmap Heap Scan on as_adm_hierarchy h1  (cost=9.36..249.67 rows=58 width=29) (actual time=0.034..0.036 rows=1 loops=1)"
"                                        Recheck Cond: ((parent_obj_id = 0) OR (parent_obj_id IS NULL))"
"                                        Filter: is_active"
"                                        Heap Blocks: exact=1"
"                                        ->  BitmapOr  (cost=9.36..9.36 rows=63 width=0) (actual time=0.025..0.026 rows=0 loops=1)"
"                                              ->  Bitmap Index Scan on ie1_as_adm_hierarchy  (cost=0.00..4.90 rows=63 width=0) (actual time=0.017..0.017 rows=1 loops=1)"
"                                                    Index Cond: (parent_obj_id = 0)"
"                                              ->  Bitmap Index Scan on ie1_as_adm_hierarchy  (cost=0.00..4.44 rows=1 width=0) (actual time=0.007..0.007 rows=0 loops=1)"
"                                                    Index Cond: (parent_obj_id IS NULL)"
"                      ->  Index Scan using pk_as_object_level on as_object_level l  (cost=0.14..0.16 rows=1 width=226) (actual time=0.020..0.020 rows=1 loops=1)"
"                            Index Cond: (level_id = a.obj_level)"
"                            Filter: is_active"
"                ->  Index Scan using pk_as_operation_type on as_operation_type ot  (cost=0.14..0.16 rows=1 width=226) (actual time=0.005..0.005 rows=1 loops=1)"
"                      Index Cond: (oper_type_id = a.oper_type_id)"
"                      Filter: is_active"
"          ->  Nested Loop  (cost=1415.12..2777.63 rows=4 width=642) (actual time=195.549..234.321 rows=5308 loops=5)"
"                ->  Hash Join  (cost=1414.98..2776.32 rows=8 width=391) (actual time=195.527..216.589 rows=5308 loops=5)"
"                      Hash Cond: (a_1.obj_level = l_1.level_id)"
"                      ->  Hash Join  (cost=1413.71..2774.99 rows=17 width=173) (actual time=194.404..213.515 rows=5308 loops=5)"
"                            Hash Cond: (a_1.object_id = h2.object_id)"
"                            ->  Seq Scan on as_addr_obj a_1  (cost=0.00..1250.33 rows=29538 width=100) (actual time=0.008..13.433 rows=29526 loops=5)"
"                                  Filter: (end_date > CURRENT_DATE)"
"                                  Rows Removed by Filter: 6496"
"                            ->  Hash  (cost=1405.86..1405.86 rows=628 width=81) (actual time=191.527..191.528 rows=188082 loops=5)"
"                                  Buckets: 1048576 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 108785kB"
"                                  ->  Nested Loop  (cost=0.75..1405.86 rows=628 width=81) (actual time=4.265..134.813 rows=188082 loops=5)"
"                                        Join Filter: (aa1_1.id_addr_obj = h2.parent_obj_id)"
"                                        ->  Hash Join  (cost=0.33..1361.52 rows=10 width=68) (actual time=4.236..20.471 rows=5309 loops=5)"
"                                              Hash Cond: (z.object_id = aa1_1.id_addr_obj)"
"                                              ->  Seq Scan on as_addr_obj z  (cost=0.00..1250.33 rows=29538 width=24) (actual time=0.008..12.651 rows=29526 loops=5)"
"                                                    Filter: (end_date > CURRENT_DATE)"
"                                                    Rows Removed by Filter: 6496"
"                                              ->  Hash  (cost=0.20..0.20 rows=10 width=44) (actual time=2.433..2.433 rows=5309 loops=5)"
"                                                    Buckets: 32768 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 2346kB"
"                                                    ->  WorkTable Scan on aa1 aa1_1  (cost=0.00..0.20 rows=10 width=44) (actual time=0.003..1.596 rows=5309 loops=5)"
"                                        ->  Index Scan using ie1_as_adm_hierarchy on as_adm_hierarchy h2  (cost=0.43..3.67 rows=61 width=29) (actual time=0.004..0.017 rows=35 loops=26543)"
"                                              Index Cond: (parent_obj_id = z.object_id)"
"                                              Filter: is_active"
"                                              Rows Removed by Filter: 2"
"                      ->  Hash  (cost=1.17..1.17 rows=8 width=226) (actual time=0.020..0.020 rows=17 loops=1)"
"                            Buckets: 1024  Batches: 1  Memory Usage: 10kB"
"                            ->  Seq Scan on as_object_level l_1  (cost=0.00..1.17 rows=8 width=226) (actual time=0.011..0.014 rows=17 loops=1)"
"                                  Filter: is_active"
"                ->  Index Scan using pk_as_operation_type on as_operation_type ot_1  (cost=0.14..0.16 rows=1 width=226) (actual time=0.002..0.002 rows=1 loops=26542)"
"                      Index Cond: (oper_type_id = a_1.oper_type_id)"
"                      Filter: is_active"
"  ->  Unique  (cost=194.72..194.74 rows=5 width=1330) (actual time=1366.229..1366.238 rows=13 loops=1)"
"        ->  Sort  (cost=194.72..194.73 rows=5 width=1330) (actual time=1366.228..1366.233 rows=13 loops=1)"
"              Sort Key: bb1.id_addr_obj"
"              Sort Method: quicksort  Memory: 31kB"
"              ->  Subquery Scan on bb1  (cost=1.22..194.66 rows=5 width=1330) (actual time=1334.960..1366.212 rows=13 loops=1)"
"                    Filter: (bb1.qty > 1)"
"                    Rows Removed by Filter: 26530"
"                    ->  WindowAgg  (cost=1.22..1.61 rows=14 width=1370) (actual time=1333.495..1364.817 rows=26543 loops=1)"
"                          ->  Sort  (cost=1.22..1.26 rows=14 width=1354) (actual time=1333.476..1337.649 rows=26543 loops=1)"
"                                Sort Key: aa1.id_addr_parent, aa1.addr_obj_type_id, (upper((aa1.nm_addr_obj)::text))"
"                                Sort Method: quicksort  Memory: 14448kB"
"                                ->  CTE Scan on aa1  (cost=0.00..0.96 rows=14 width=1354) (actual time=12.344..1287.922 rows=26543 loops=1)"
"                                      Filter: (obj_level <= '16'::bigint)"
"                    SubPlan 4"
"                      ->  CTE Scan on z z_2  (cost=38.55..38.58 rows=1 width=8) (never executed)"
"                            CTE z"
"                              ->  Seq Scan on as_addr_obj_type t  (cost=0.00..15.67 rows=1 width=43) (never executed)"
"                                    Filter: (((type_shortname)::text = (bb1.addr_obj_type)::text) AND ((type_level)::bigint = bb1.obj_level))"
"                            InitPlan 3 (returns $9)"
"                              ->  Hash Join  (cost=17.50..22.89 rows=1 width=8) (never executed)"
"                                    Hash Cond: ((z_1.fias_row_key = gar_tmp_pcg_trans.f_xxx_replace_char((r.type_name)::text, '{*,&,$,@,:,.,(,),/,-,_,""\\""}'::bpchar[])) AND ((z_1.type_level)::text = (r.type_level)::text))"
"                                    ->  CTE Scan on z z_1  (cost=0.00..0.02 rows=1 width=70) (never executed)"
"                                    ->  Hash  (cost=11.21..11.21 rows=419 width=33) (never executed)"
"                                          ->  Seq Scan on as_addr_obj_type r  (cost=0.00..11.21 rows=419 width=33) (never executed)"
"                                                Filter: is_active"
"Planning Time: 4.208 ms"
"Execution Time: 1369.421 ms"
