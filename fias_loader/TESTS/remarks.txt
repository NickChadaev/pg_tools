2023-09-08
-----------

В процессе миграции данных  по БФЛ в Дагестане  выявлено порядка 1500 адресов, которые есть в ФИАСе, но отсутствуют в адресном справочнике БФЛ и СРМ. 

Необходимо:

    Выявить причину по которой данные адреса отсутствуют в справочнике СРМ
    Доработать (при необходимости) алгоритм обновления справочника ФИАС, чтобы все адреса попадали в справочник

Реестр  ЛС с отсутствующими адресами (в колонке ГУИД действительные идентификаторы ФИАС) во вложении.


2023-09-25
----------

1) ПОИСК отсутсвующих адресов.
     Дополнительно, где ищем ?????   GAR_FIAS
                                     history

-+ 2) Самое главное, определить типы неуществующих адресов.  ???  (Дома, н не все)

++ 3) Ещё более важное -- создать таблицу.

++ 4) Ещё более важное -- выбрать схему, в которой будет хранится рабочая таблица.

++ 5) Хост для работы.


----------------------------------------------------------------------
-- 

2023-09-26 

             -+ Какие UUIDs домов попали в центральную БД. 
             -+ Какие UUIDs домов попали в БД-05.
             -+ Какие UUIDs домов есть GAR_FIAS
             
2023-09-27
          
             -- Нужен стенд для отладки
             
                 ++  Текущая БД
                 ++  05  (01 -- 10)
                 --  Целый кластер ???
                 
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -a -f unnsi_prd_test_20230927.sql unnsi_prd_test 1> d.out 2>d.err &                 

++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_01_20230927.sql unsi_test_01 1> d01.out 2>d01.err &                 
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_02_20230927.sql unsi_test_02 1> d02.out 2>d02.err &                 
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_03_20230927.sql unsi_test_03 1> d03.out 2>d03.err &                 
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_04_20230927.sql unsi_test_04 1> d04.out 2>d04.err &                  
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_05_20230927.sql unsi_test_05 1> d05.out 2>d05.err &                               
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_06_20230927.sql unsi_test_06 1> d06.out 2>d06.err &                  
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_07_20230927.sql unsi_test_07 1> d07.out 2>d07.err &                  
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_08_20230927.sql unsi_test_08 1> d08.out 2>d08.err &                  
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_09_20230927.sql unsi_test_09 1> d09.out 2>d09.err &                  
++ pg_dump -h 10.196.35.165 -U postgres -p 5432 -C -f unsi_test_10_20230927.sql unsi_test_10 1> d10.out 2>d10.err &

--------------------------------
Мучения от собственной глупости.
DROP SERVER IF EXISTS unnsi_prd_s;
CREATE SERVER unnsi_prd_s FOREIGN DATA WRAPPER postgres_fdw
    OPTIONS (dbname 'unnsi_prd_test', host '127.0.0.1', port '5434');
    
#  Помнить об этом нужно    
./post_proc.sh /home/n.chadaev@abrr.local/tmp up_prds_20230925
./


-- Модификация функции  (0, 1, 2)
-- Модификаця таблицы
-- Контрольный запрос 53.

-- Чьи это идентификаторы ????  Почему они не находятся.


2023-09-28 -- Записи без родителей ( 111 домов)
------------
Задача: пересмотреть запрос формирующий  список-агрегат адресных пространств
        Восстановить нарушенную целостнность БД.
        
Как делаем ?   (111 домов)
     1) JOIN С РОДИТЕЛЯМИ    as_addr_obj, ЕСТЬ ЛИ ОНИ ???


Записи без родителей.
-- home JOIN с as_addr_obj --есть ли они ?

